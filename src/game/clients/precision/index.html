<!doctype html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>Precision Client</title>
		<link rel="icon" type="image/webp" href="/resources/images/icons/clients/precision.webp" />
		<link rel="stylesheet" href="/resources/styles/eagler.css" />
		<script src="/resources/scripts/google-tag.js"></script>
		<script src="/game/web/clients/precision/eagswebrtc.js"></script>
		<script src="/game/web/clients/precision/classes.js"></script>
		<script async src="/game/web/clients/precision/arc-sw.js"></script>
		<style>
			@font-face {
				font-family: 'Product Sans';
				src: url(ProductSans.ttf);
			}

			html {
				color: #fff;
			}

			.starter {
				border-radius: 5px;
				border: 1px solid #fff;
				background-color: #0d0c0c;
				color: #fff;
			}

			.dropdown {
				position: relative;
				display: inline-block;
				border-radius: 5px;
				border: 1px solid #fff;
				background-color: #0d0c0c;
				color: #fff;
			}

			.gameframe {
				background-image: url('bg.png');
				background-size: cover;
				font-family: 'Product Sans';
			}

			#Selection {
				display: inline-block;
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
			}
		</style>
	</head>
	<body id="game_frame" class="gameframe">
		<div id="Selection">
			<h1>Precision Client</h1>
			<h3>Select a texture pack:</h3>
			<select id="Packs" class="dropdown">
				<option disabled selected hidden value="">-- Choose one --</option>
				<option value="defaultold">Default Old</option>
				<option value="defaultnew">Default 1.17+</option>
				<option value="bombies">Bombies 180k</option>
				<option value="bones">Bare Bones</option>
				<option value="modifiednew">Modified 1.17+</option>
				<option value="miamiprivate">Miami Private</option>
				<option value="nebula">Nebula</option>
				<option value="rhedd">Rhedd</option>
				<option value="ricefault">Ricefault</option>
				<option value="tightfault">Tightfault</option>
				<option value="walifault">Walifault</option>
			</select>
			<br /><br />
			<input class="starter" type="button" value="Launch" onclick="Start();" />
		</div>
		<script>
			'use strict';
			const PackSelect = document.getElementById('Packs');
			PackSelect.value = localStorage.getItem('precisionClientLastPack') || '';

			function Start() {
				if (PackSelect.value) {
					const Selected = PackSelect.value;
					document.getElementById('Selection').style.display = 'none';
					localStorage.setItem('precisionClientLastPack', Selected);

					const relayId = Math.floor(Math.random() * 3);
					window.eaglercraftOpts = {
						container: 'game_frame',
						assetsURI: `${window.location.pathname}/packs/${Selected}.epk`,
						localesURI: `${window.location.pathname}/lang/`,
						serverWorkerURI: `${window.location.pathname}/worker_bootstrap.js`,
						worldsFolder: 'MAIN',
						servers: [],
						relays: [
							{
								addr: 'wss://relay.deev.is/',
								name: 'lax1dude relay #1',
								primary: relayId === 0,
							},
							{
								addr: 'wss://relay.lax1dude.net/',
								name: 'lax1dude relay #2',
								primary: relayId === 1,
							},
							{
								addr: 'wss://relay.shhnowisnottheti.me/',
								name: 'ayunami relay #1',
								primary: relayId === 2,
							},
						],
						mainMenu: {
							splashes: [],
							eaglerLogo: false,
						},
						assetOverrides: {
							'records/wait.mp3': 'wait.mp3',
							'records/mellohi.mp3':
								'https://stream.nightride.fm/chillsynth.m4a',
							'records/far.mp3': 'https://stream.nightride.fm/nightride.m4a',
							'records/cat.mp3': 'http://usa9.fastcast4u.com/proxy/jamz?mp=/1',
							'records/ward.mp3': 'http://fr4.1mix.co.uk:8000/192h',
							'records/strad.mp3': 'http://listen.011fm.com:8028/stream15',
							'records/blocks.mp3': 'https://www.ophanim.net:8444/s/9780',
							'records/13.mp3': 'https://s2.radio.co/s2b2b68744/listen',
							'credits.txt': 'assetoverrides/credits.txt',
							'precision/gui.png': 'assetoverrides/precision/gui.png',
							'precision/gui2.png': 'assetoverrides/precision/gui2.png',
							'precision/guismall.png': 'assetoverrides/precision/guismall.png',
							'precision/logo.png': 'assetoverrides/precision/logo.png',
							'precision/precision.png':
								'assetoverrides/precision/precision.png',
							'precision/precision2.png':
								'assetoverrides/precision/precision2.png',
							'lang/en_US.lang': 'assetoverrides/lang/en_US.lang',
							'gui/demo_bg.png': 'assetoverrides/gui/demo_bg.png',
							'title/bg/panorama0.png': 'assetoverrides/title/bg/panorama0.png',
							'title/bg/panorama1.png': 'assetoverrides/title/bg/panorama1.png',
							'title/bg/panorama2.png': 'assetoverrides/title/bg/panorama2.png',
							'title/bg/panorama3.png': 'assetoverrides/title/bg/panorama3.png',
							'title/bg/panorama4.png': 'assetoverrides/title/bg/panorama4.png',
							'title/bg/panorama5.png': 'assetoverrides/title/bg/panorama5.png',
						},
					};

					const urlParams = new URLSearchParams(window.location.search);
					window.eaglercraftOpts.joinServer =
						urlParams.get('server') ?? undefined;

					main();
				} else alert('You need to select a pack');
			}
		</script>
	</body>
</html>
